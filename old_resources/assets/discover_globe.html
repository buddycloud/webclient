<!doctype html>
<html lang="en" class="discover">
<head>
  <title>buddycloud Discover</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="web/css/main.css" type="text/css" media="screen">
  <script type="text/javascript" src="config.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="web/js/app.js"></script>
  <script src="web/js/livecss.js"></script>
</head>
<body>
  <h1>Discover</h1>
  <div class="personal channel">
    <div class="avatar" style="background-image: url(public/avatars/user1.jpg)">
      <span class="channelpost counter">2</span>
      <span class="message counter">2</span>
    </div>
    <div class="info">
      <span class="owner">felix<span class="domain">@buddycloud.com</span></span>
      <span class="status">Aww yeah, Lion rocks</span>
    </div>
  </div>
  <div class="search">
    <input type="search" results="5" autosave="channelSearch" placeholder="Search Channels ..." />
  </div>
  <div class="channel selected">
    <div class="avatar" style="background-image: url(public/avatars/user2.jpg)">
      <span class="channelpost counter">2</span>
    </div>
    <div class="info">
      <span class="owner">vera<span class="domain">@buddycloud.com</span></span>
      <span class="status">What a wonderful day</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel2.jpg)">
      <span class="channelpost counter admin">1</span>
    </div>
    <div class="info">
      <span class="owner">moviefans<span class="domain">@buddycloud.com</span></span>
      <span class="status">Harry Potter, tonight!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel3.jpg)">
      <span class="channelpost counter admin">1</span>
    </div>
    <div class="info">
      <span class="owner">on-the-box<span class="domain">@bbc.co.uk</span></span>
      <span class="status">You gonna love the new Dexter episodes</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/topic.png)">
      <span class="channelpost counter">2</span>
    </div>
    <div class="info">
      <span class="owner">lolcats<span class="domain">@buddycloud.com</span></span>
      <span class="status">I can haz your nose?</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/user4.jpg)">
    </div>
    <div class="info">
      <span class="owner">martin<span class="domain">@buddycloud.com</span></span>
      <span class="status">working on the webgl project</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/topic.png)">
    </div>
    <div class="info">
      <span class="owner">music<span class="domain">@buddycloud.com</span></span>
      <span class="status">New Foo Fighter Album online - check it out!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/user7.jpg)">
    </div>
    <div class="info">
      <span class="owner">verena<span class="domain">@buddycloud.com</span></span>
      <span class="status">test's are over - party!!!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel7.jpg)">
    </div>
    <div class="info">
      <span class="owner">fans<span class="domain">@steam.com</span></span>
      <span class="status">the cake is a lie!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel8.jpg)">
    </div>
    <div class="info">
      <span class="owner">cave<span class="domain">@minecraft.com</span></span>
      <span class="status">Buy minecraft - now!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/anon.png)">
      <span class="channelpost counter">2</span>
    </div>
    <div class="info">
      <span class="owner">steve<span class="domain">@buddycloud.com</span></span>
      <span class="status">all your base belongs to us</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel2.jpg)">
      <span class="channelpost counter admin">1</span>
    </div>
    <div class="info">
      <span class="owner">moviefans<span class="domain">@buddycloud.com</span></span>
      <span class="status">Harry Potter, tonight!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel3.jpg)">
      <span class="channelpost counter admin">1</span>
    </div>
    <div class="info">
      <span class="owner">on-the-box<span class="domain">@bbc.co.uk</span></span>
      <span class="status">You gonna love the new Dexter episodes</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel4.jpg)">
      <span class="channelpost counter">2</span>
    </div>
    <div class="info">
      <span class="owner">lolcats<span class="domain">@buddycloud.com</span></span>
      <span class="status">I can haz your nose?</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/user4.jpg)">
    </div>
    <div class="info">
      <span class="owner">martin<span class="domain">@buddycloud.com</span></span>
      <span class="status">working on the webgl project</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel6.jpg)">
    </div>
    <div class="info">
      <span class="owner">music<span class="domain">@buddycloud.com</span></span>
      <span class="status">New Foo Fighter Album online - check it out!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/user7.jpg)">
    </div>
    <div class="info">
      <span class="owner">verena<span class="domain">@buddycloud.com</span></span>
      <span class="status">test's are over - party!!!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel7.jpg)">
    </div>
    <div class="info">
      <span class="owner">fans<span class="domain">@steam.com</span></span>
      <span class="status">the cake is a lie!</span>
    </div>
  </div>
  <div class="channel">
    <div class="avatar" style="background-image: url(public/avatars/channel8.jpg)">
    </div>
    <div class="info">
      <span class="owner">cave<span class="domain">@minecraft.com</span></span>
      <span class="status">Buy minecraft - now!</span>
    </div>
  </div>
  <div class="content">
    <div class="channelView personal scrollHolder clearfix">
        <!--<div class="banner" style="background-image: url(public/images/vera_bg.jpg);"></div>-->
        <header>
          <a href="http://www.buddycloud.com" id="poweredby">powered by buddycloud</a>
          <img class="avatar" src="public/avatars/user2.jpg" />
          <div class="titleBar">
            <h2 class="title" data-editmode="singleLine">Vera Meisterkoch's World</h2>
            <span class="status" data-editmode="singleLine">Hanging out with the world at my feet</span>
          </div>
          <nav class="inChannel">
            <div class="messages button newMessage">
              <span class="holder">Messages</span><span class="message counter">2</span>
            </div>
            <div class="channel button">
              <span class="holder">Channel</span>
            </div>
            <div class="edit button">Edit</div>
          </nav>
        </header>
        <section class="stream clearfix">
          <section class="newTopic">
            <img class="avatar" src="public/avatars/user1.jpg" />
            <textarea placeholder="New Topic..."></textarea>
            <div class="controls">
              <div class="button checkbox">
                <input type="checkbox" id="shouldShareLocation" />
                <label for="shouldShareLocation">Share Location: Home</label>
              </div>
              <div class="button prominent" id="createNewTopic">Post</div>
            </div>
          </section>
          <!-- this produces some weird bug - some content below
	    it gets lost when this is visible -->
	  <div class="notifications">
	    <article class="notification">
	      <section>
                <img class="avatar" src="public/avatars/user4.jpg" />
                <div class="info">
  	        <span class="name">martin<span class="domain">@buddycloud.com</span></span>
                  <p>wants to follow this channel.</p>
                  <span class="granted">started following this channel.</span>
                  <span class="denied">was denied to follow this channel.</span>
                </div>
                <div class="controls">
                  <div class="button small negative light">Deny</div>
                  <div class="button small positive light">Grant Martin to join</div>
                </div>
              </section>
	    </article>
	  </div>
          <section class="topics">
            <article class="topic">
              <section class="opener">
                <img class="avatar" src="public/avatars/user2.jpg" />
                <div class="postmeta">
                  <span class="format-date time ago" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M" title="5:06pm 06.06.2011">1 minute</span>
                </div>
                <span class="name">vera<span class="domain">@buddycloud.com</span></span><span class="location">from Home</span>
                <p>So it looks like Andi finally joined: <a class="internal" href="buddycloud.com/andi@buddycloud.com">andi<span class="domain">@buddycloud.com</span></a></p>
              </section>
              <section class="comments">
                <section class="answer">
                  <img class="avatar" src="public/avatars/user1.jpg" />
                  <textarea placeholder="add comment (use CTRL enter to add automatically)"></textarea>
                  <div class="controls">
                    <div class="button small checkbox">
                      <input type="checkbox" id="shouldShareLocation123" />
                      <label for="shouldShareLocation123">Share Location: Home</label>
                    </div>
                    <div class="button small prominent createComment">Post</div>
                  </div>
                </section>
              </section>
            </article>
            <article class="topic">
              <section class="opener">
                <img class="avatar" src="public/avatars/user2.jpg" />
                <div class="postmeta">
                  <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M" title="5:06pm 06.06.2011">5 minutes</span>
                </div>
                <span class="name">vera<span class="domain">@buddycloud.com</span></span><span class="location">from Home</span>
                <p>I'm a sociopath; there's not much he can do for me. I have a dark side, too. I will not kill my sister. I will not kill my sister. I will not kill my sister. He taught me a code. To survive. Under normal circumstances, I'd take that as a compliment. I'm generally confused most of the time.</p>
              </section>
              <section class="comments">
                <section class="answer">
                  <img class="avatar" src="public/avatars/user1.jpg" />
                  <textarea placeholder="add comment (use CTRL enter to add automatically)"></textarea>
                  <div class="controls">
                    <div class="button small checkbox">
                      <input type="checkbox" id="shouldShareLocation124" />
                      <label for="shouldShareLocation124">Share Location: Home</label>
                    </div>
                    <div class="button small prominent createComment">Post</div>
                  </div>
                </section>
              </section>
            </article>
            <article class="topic">
              <section class="opener">
                <img class="avatar" src="public/avatars/user2.jpg" />
                <div class="postmeta">
                  <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                </div>
                <span class="name">vera<span class="domain">@buddycloud.com</span></span><span class="location">from Campus Library</span>
                <p>Pretend. You pretend the feelings are there, for the world, for the people around you.</p>
              </section>
              <section class="comments">
                <section class="comment">
                  <img class="avatar" src="public/avatars/user6.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">mona<span class="domain">@buddycloud.com</span></span><span class="location">from Cafe Extra</span>
                  <p>Who knows? Maybe one day they will be. I like seafood.</p>
                </section>
                <section class="comment">
                  <img class="avatar" src="public/avatars/user7.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">verena<span class="domain">@buddycloud.com</span></span><span class="location">from Home</span>
                  <p>Finding a needle in a haystack isn't hard when every straw is computerized. I'm really more an apartment person.</p>
                </section>
                <section class="comment">
                  <img class="avatar" src="public/avatars/user11.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">betty<span class="domain">@buddycloud.com</span></span><span class="location">from Donau</span>
                  <p>I feel like a jigsaw puzzle missing a piece. And I'm not even sure what the picture should be.</p>
                </section>
                <section class="comment">
                  <img class="avatar" src="public/avatars/user13.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">daniel<span class="domain">@buddycloud.com</span></span><span class="location">from Home</span>
                  <p>I'm going to tell you something that I've never told anyone before.</p>
                </section>
                <section class="answer">
                  <img class="avatar" src="public/avatars/user1.jpg" />
                  <textarea placeholder="add comment (use CTRL enter to add automatically)"></textarea>
                  <div class="controls">
                    <div class="button small checkbox">
                      <input type="checkbox" id="shouldShareLocation125" />
                      <label for="shouldShareLocation125">Share Location: Home</label>
                    </div>
                    <div class="button small prominent createComment">Post</div>
                  </div>
                </section>
              </section>
            </article>
            <article class="topic">
              <section class="opener">
                <img class="avatar" src="public/avatars/user2.jpg" />
                <div class="postmeta">
                  <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                </div>
                <span class="name">vera<span class="domain">@buddycloud.com</span></span><span class="location">from Munich</span>
                <p>Pretend. You pretend the feelings are there, for the world, for the people around you.</p>
              </section>
              <section class="comments">
                <section class="comment">
                  <img class="avatar" src="public/avatars/user3.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">Tom</span><span class="location">from Men's Cave</span>
                  <p>Who knows? Maybe one day they will be. I like seafood.</p>
                </section>
                <section class="comment">
                  <img class="avatar" src="public/avatars/user5.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">gero<span class="domain">@buddycloud.com</span></span><span class="location">from Regensburg</span>
                  <p>Finding a needle in a haystack isn't hard when every straw is computerized. I'm really more an apartment person.</p>
                </section>
                <section class="comment">
                  <img class="avatar" src="public/avatars/user2.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">vera<span class="domain">@buddycloud.com</span></span><span class="location">from Munich</span>
                  <p>I feel like a jigsaw puzzle missing a piece. And I'm not even sure what the picture should be.</p>
                </section>
                <section class="comment">
                  <img class="avatar" src="public/avatars/user12.jpg" />
                  <div class="postmeta">
                    <span class="time" data-strftime="%d.%m.%Y %H:%M" data-strftitle="%A %d %B %Y %H:%M">3 days</span>
                  </div>
                  <span class="name">sebastian<span class="domain">@buddycloud.com</span></span><span class="location">from Passau</span>
                  <p>I'm going to tell you something that I've never told anyone before.</p>
                </section>
              </section>
            </article>
          </section>
          <p class="loader">
            <span class="spinner"></span>
          </p>
        </section><!-- /stream -->
        <div class="channelDetails hidden">
          <div class="infoToggle">
            <h4 class="title">Info</h4>
            <span class="icon"></span>
          </div>
          <div class="holder">
            <section class="meta">
              <p class="owner">
                <span class="title">Owner:</span>
		<span class="data">vera<span class="domain">@buddycloud.com</span></span>
              </p>
              <p class="description">
                <span class="title">About me:</span>
		<span class="data" data-editmode="multiLine">I'm Vera, I love to cook, I love clothes and most of all, I love my boyfriend.</span>
              </p>
              <p class="open">
                <span class="title">This Channel is:</span>
		<span class="data accessModel" data-editmode="boolean">Public</span>
              </p>
              <p class="broadcast">
                <span class="title">Broadcasting since:</span>
		<span class="data format-date time"
		      data-strftime="%d.%m.%Y %H:%M"
		      data-strftitle="%A %d %B %Y %H:%M">188 days</span>
              </p>
              <p class="location">
                <span class="title">Location:</span>
                <span class="previous">Home</span> → 
                <span class="current">Shopping</span> → 
                <span class="next">Home</span>
              </p>
            </section>
            <section class="channelList">
              <h3>moderators <span class="count">1</count></h3>
              <div class="list">
                <img src="public/avatars/user2.jpg" />
              </div>
            </section><!-- /followers -->
            <section class="channelList">
              <h3>followers <span class="count">20</count></h3>
              <div class="list">
                <img src="public/avatars/user3.jpg" class="selected" />
                <img src="public/avatars/user4.jpg" />
                <img src="public/avatars/user5.jpg" />
                <img src="public/avatars/user6.jpg" />
                <div class="adminAction first choosen role moderator">
                  <div class="arrow"></div>
                  <div class="holder">
                    <div class="box">
                      <section class="channelInfo">
                        <h4>tom<span class="domain">@buddycloud.com</span></h4>
                        <div class="currentRole">Follower</div>
                      </section>
                      <section class="action changeRole">
                        <h5>Change Role</h5>
                        <select>
                          <option value="moderator">Moderator</option>
                          <option value="followerPlus">Follower+Post</option>
                          <option value="follower" selected>Follower</option>
                        </select>
                        <section class="info">
                          <div class="moderator">
                            <ul>
                              <li>read your channel</li>
                              <li>write comments &amp; messages</li>
                              <li>post new topics</li>
                              <li>add &amp; ban users</li>
                              <li>set user's roles</li>
                            </ul>
                          </div>
                          <div class="followerPlus">
                            <ul>
                              <li>read your channel</li>
                              <li>write comments &amp; messages</li>
                              <li>post new topics</li>
                            </ul>
                          </div>
                          <div class="follower">
                            <ul>
                              <li>read your channel</li>
                            </ul>
                          </div>
                        </section>
                      </section>
                      <section class="action banUser">
                        <h5>Ban User</h5>
                        <div class="info">
                          <ul>
                            <li class="negative">Remove access to channel.</li>
                          </ul>
                        </div>
                      </section>
                      <section class="actionRow choose">
                        <div>Change Role</div>
                        <div>Ban User</div>
                      </section>  
                      <section class="actionRow confirm">
                        <div>Cancel</div>
                        <div>Ok</div>
                      </section>
                    </div><!-- /box -->
                  </div>
                </div>
                <img src="public/avatars/user7.jpg" />
                <img src="public/avatars/user8.jpg" />
                <img src="public/avatars/user9.jpg" />
                <img src="public/avatars/user10.jpg" />
                <img src="public/avatars/user11.jpg" />
                <img src="public/avatars/user12.jpg" />
                <img src="public/avatars/user13.jpg" />
                <img src="public/avatars/channel8.jpg" />
              </div>
              <div class="showAll">show all</div>
            </section><!-- /followers -->
            <section class="channelList">
              <h3>channels nearby <span class="count">10</count></h3>
              <div class="list">
                <img src="public/avatars/channel1.jpg" />
                <img src="public/avatars/channel2.jpg" />
                <img src="public/avatars/channel3.jpg" />
                <img src="public/avatars/channel4.jpg" />
              </div>
              <div class="showAll">show all</div>
            </section><!-- /followers -->
            <section class="channelList">
              <h3>similar channels <span class="count">8</count></h3>
              <div class="list">
                <img src="public/avatars/channel5.jpg" />
                <img src="public/avatars/channel6.jpg" />
                <img src="public/avatars/channel7.jpg" />
                <img src="public/avatars/channel8.jpg" />
              </div>
              <div class="showAll">show all</div>
            </section><!-- /followers -->
          </div><!-- /holder -->
        </div><!-- /detail -->
      </div><!-- /channelView -->
  </div><!-- /content -->
<script type="text/javascript">
  var channels = $('.channel:not(.personal)');
  var personalChannel = $('.channel.personal');
  var step = 360/(channels.length-1);
  var distance = {
    x : $('body').width()*0.3,
    y : $('body').height()*0.4
  };
  var center = {
    x : $('body').width()*0.5,
    y : $('body').height()*0.5
  };
  var timeOffset = 30;
  var counter = 0;
  var isOpen = false;
  
  function init(){
    counter = 0;
    channels.css({ top: center.y, left: center.x });
    isOpen = false;
  }
  init();
  
  function open(){
    //setTimeout(position, timeOffset*5);
    channels.each(position);
    isOpen = true;
  }
  
  
  function position(){
    var angle = step * counter;
    var top = center.y - distance.y * Math.cos(angle*Math.PI/180);
    var left = center.x - distance.x * Math.sin(angle*Math.PI/180);
    channels.eq(counter).css({
      left : left,
      top : top,
      '-webkit-transition': '500ms'
    });
    //if(counter < channels.length) setTimeout(position, timeOffset);
    counter++;
  }
  
  $(document).ready(open);
  
  $(window).bind({
    keydown: keydownHandler,
    keyup: keyupHandler
  });
  
  // direction can be
  //
  //     7  0  1  
  //      \ | /
  //    6 - o - 2
  //      / | \
  //     5  4  3
  //
  // outdated. but it looks nice, so it stays.
  //
  // x and y-direction can be [-1, 0, 1]
  var direction = {
    x : 0,
    y : 0,
  };
  var keys = [37, 38, 39, 40];
  moveTimeout = false;
  
  function keydownHandler(event){
    if(keys.indexOf(event.keyCode) != -1){
      switch(event.keyCode){
        case 37: // left
          direction.x = -1;
          break;
        case 38: // top
          direction.y = -1;
          break;
        case 39: // right
          direction.x = 1;
          break;
        case 40: // down
          direction.y = 1;
          break;
      }
      if(!moveTimeout) move();
    } else {
      if(event.keyCode === 13) isOpen ? init() : open();
    }
  }
  
  function keyupHandler(event){
    // remove steering direction
    switch(event.keyCode){
      case 37: case 39:
        direction.x = 0;
        break;
      case 38: case 40:
        direction.y = 0;
        break;
    }
  }
  
  var speed = 5;
  
  function move(){
    center.x += direction.x * speed;
    center.y += direction.y * speed;
    personalChannel.css({'left': center.x, 'top': center.y });
    if(!isOpen) channels.css({'left': center.x, 'top': center.y, '-webkit-transition': 'none' });
    if(direction.x != 0 || direction.y != 0){
      moveTimeout = setTimeout(move, 30);
    } else {
      moveTimeout = false;
    }
  } 
</script>
</body>
</html>
